set max_line_width 200;
OK

topic1 := (kafka in partitions = 10)
-> (project   
    key,
    json_int("v0",val) as v0,
    json_float("v1",val) as v1,
    json_bool("v2",val) as v2,
    to_decimal(json_string("v3", val),38,6) as v3,
    json_string("v4", val) as v4,
    to_bytes(json_string("v5", val)) as v5,
    parse_date(json_string("v6", val), "2006-01-02 15:04:05.999999") as v6)
-> (store stream);
OK

topic2 := (kafka in partitions = 1)
-> (project   
    key,
    json_int("v0",val) as v0,
    json_float("v1",val) as v1,
    json_bool("v2",val) as v2,
    to_decimal(json_string("v3", val),38,6) as v3,
    json_string("v4", val) as v4,
    to_bytes(json_string("v5", val)) as v5,
    parse_date(json_string("v6", val), "2006-01-02 15:04:05.999999") as v6)
-> (store stream);
OK

topic3 := (kafka in partitions = 1000)
-> (project   
    key,
    json_int("v0",val) as v0,
    json_float("v1",val) as v1,
    json_bool("v2",val) as v2,
    to_decimal(json_string("v3", val),38,6) as v3,
    json_string("v4", val) as v4,
    to_bytes(json_string("v5", val)) as v5,
    parse_date(json_string("v6", val), "2006-01-02 15:04:05.999999") as v6)
-> (store stream);
OK

--produce data dataset_1;
--produce data dataset_2;
--produce data dataset_3;

(scan all from topic1) -> (sort by key);
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key          | v0                   | v1           | v2           | v3           | v4           | v5           | v6                         |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01        | 1000                 | 1.230000     | true         | 12345678.7.. | foobar01     | somebytes01  | 2008-04-03 23:21:17.123000 |
| 0                    | 2006-01-02 15:05:05.000000 | key02        | 1001                 | 2.230000     | false        | 22345678.7.. | foobar02     | somebytes02  | 2008-04-03 23:22:17.123000 |
| 0                    | 2006-01-02 15:06:05.000000 | key03        | 1002                 | 3.230000     | true         | 32345678.7.. | foobar03     | somebytes03  | 2008-04-03 23:23:17.123000 |
| 0                    | 2006-01-02 15:07:05.000000 | key04        | 1003                 | 4.230000     | false        | 42345678.7.. | foobar04     | somebytes04  | 2008-04-03 23:24:17.123000 |
| 0                    | 2006-01-02 15:08:05.000000 | key05        | 1004                 | 5.230000     | true         | 52345678.7.. | foobar05     | somebytes05  | 2008-04-03 23:25:17.123000 |
| 1                    | 2006-01-02 15:09:05.000000 | key06        | 1005                 | 6.230000     | false        | 62345678.7.. | foobar06     | somebytes06  | 2008-04-03 23:26:17.123000 |
| 1                    | 2006-01-02 15:10:05.000000 | key07        | 1006                 | 7.230000     | true         | 72345678.7.. | foobar07     | somebytes07  | 2008-04-03 23:27:17.123000 |
| 1                    | 2006-01-02 15:11:05.000000 | key08        | 1007                 | 8.230000     | false        | 82345678.7.. | foobar08     | somebytes08  | 2008-04-03 23:28:17.123000 |
| 0                    | 2006-01-02 15:12:05.000000 | key09        | 1008                 | 9.230000     | true         | 92345678.7.. | foobar09     | somebytes09  | 2008-04-03 23:29:17.123000 |
| 2                    | 2006-01-02 15:13:05.000000 | key10        | 1009                 | 10.230000    | false        | 102345678... | foobar10     | somebytes10  | 2008-04-03 23:30:17.123000 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
10 rows returned
(scan all from topic2) -> (sort by key);
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key          | v0                   | v1           | v2           | v3           | v4           | v5           | v6                         |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01        | 1000                 | 1.230000     | true         | 12345678.7.. | foobar01     | somebytes01  | 2008-04-03 23:21:17.123000 |
| 1                    | 2006-01-02 15:05:05.000000 | key02        | 1001                 | 2.230000     | false        | 22345678.7.. | foobar02     | somebytes02  | 2008-04-03 23:22:17.123000 |
| 2                    | 2006-01-02 15:06:05.000000 | key03        | 1002                 | 3.230000     | true         | 32345678.7.. | foobar03     | somebytes03  | 2008-04-03 23:23:17.123000 |
| 3                    | 2006-01-02 15:07:05.000000 | key04        | 1003                 | 4.230000     | false        | 42345678.7.. | foobar04     | somebytes04  | 2008-04-03 23:24:17.123000 |
| 4                    | 2006-01-02 15:08:05.000000 | key05        | 1004                 | 5.230000     | true         | 52345678.7.. | foobar05     | somebytes05  | 2008-04-03 23:25:17.123000 |
| 5                    | 2006-01-02 15:09:05.000000 | key06        | 1005                 | 6.230000     | false        | 62345678.7.. | foobar06     | somebytes06  | 2008-04-03 23:26:17.123000 |
| 6                    | 2006-01-02 15:10:05.000000 | key07        | 1006                 | 7.230000     | true         | 72345678.7.. | foobar07     | somebytes07  | 2008-04-03 23:27:17.123000 |
| 7                    | 2006-01-02 15:11:05.000000 | key08        | 1007                 | 8.230000     | false        | 82345678.7.. | foobar08     | somebytes08  | 2008-04-03 23:28:17.123000 |
| 8                    | 2006-01-02 15:12:05.000000 | key09        | 1008                 | 9.230000     | true         | 92345678.7.. | foobar09     | somebytes09  | 2008-04-03 23:29:17.123000 |
| 9                    | 2006-01-02 15:13:05.000000 | key10        | 1009                 | 10.230000    | false        | 102345678... | foobar10     | somebytes10  | 2008-04-03 23:30:17.123000 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
10 rows returned
(scan all from topic3) -> (sort by key);
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| offset               | event_time                 | key          | v0                   | v1           | v2           | v3           | v4           | v5           | v6                         |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 0                    | 2006-01-02 15:04:05.000000 | key01        | 1000                 | 1.230000     | true         | 12345678.7.. | foobar01     | somebytes01  | 2008-04-03 23:21:17.123000 |
| 0                    | 2006-01-02 15:05:05.000000 | key02        | 1001                 | 2.230000     | false        | 22345678.7.. | foobar02     | somebytes02  | 2008-04-03 23:22:17.123000 |
| 0                    | 2006-01-02 15:06:05.000000 | key03        | 1002                 | 3.230000     | true         | 32345678.7.. | foobar03     | somebytes03  | 2008-04-03 23:23:17.123000 |
| 0                    | 2006-01-02 15:07:05.000000 | key04        | 1003                 | 4.230000     | false        | 42345678.7.. | foobar04     | somebytes04  | 2008-04-03 23:24:17.123000 |
| 0                    | 2006-01-02 15:08:05.000000 | key05        | 1004                 | 5.230000     | true         | 52345678.7.. | foobar05     | somebytes05  | 2008-04-03 23:25:17.123000 |
| 0                    | 2006-01-02 15:09:05.000000 | key06        | 1005                 | 6.230000     | false        | 62345678.7.. | foobar06     | somebytes06  | 2008-04-03 23:26:17.123000 |
| 0                    | 2006-01-02 15:10:05.000000 | key07        | 1006                 | 7.230000     | true         | 72345678.7.. | foobar07     | somebytes07  | 2008-04-03 23:27:17.123000 |
| 0                    | 2006-01-02 15:11:05.000000 | key08        | 1007                 | 8.230000     | false        | 82345678.7.. | foobar08     | somebytes08  | 2008-04-03 23:28:17.123000 |
| 0                    | 2006-01-02 15:12:05.000000 | key09        | 1008                 | 9.230000     | true         | 92345678.7.. | foobar09     | somebytes09  | 2008-04-03 23:29:17.123000 |
| 0                    | 2006-01-02 15:13:05.000000 | key10        | 1009                 | 10.230000    | false        | 102345678... | foobar10     | somebytes10  | 2008-04-03 23:30:17.123000 |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
10 rows returned

delete(topic1);
OK
delete(topic2);
OK
delete(topic3);
OK
